# JVM规范

JVM规范为不同硬件平台提供编译java技术代码的规范，JVM只对.class文件感知，与开发语言无关（Java, jRuby, JPython, 甚至ASM直接写class）

虚拟机有不同版本，以下属于Oracle虚拟机

**主要内容：**

#### 1. 字节码指令集（CPU）

#### 2. class格式

**加载：**类加载过程的一个阶段：通过一个类的完全限定查找此类字节码文件，并利用字节码文件创建一个Class对象

**验证：**目的在于确保Class文件的字节流中包含信息符合当前虚拟机要求，不会危害虚拟机自身安全。主要包括四种验证，**文件格式验证，元数据验证，字节码验证，符号引用验证**。

**准备：**为类变量(即**static修饰的字段变量)分配内存**并且设置该类变量的**初始值即0**(如static int i=5;这里只将i初始化为0，至于5的值将在初始化时赋值)，这里不包含用final修饰的static，因为final在编译的时候就会分配了，注意这里不会为实例变量分配初始化，类变量会分配在方法区中，而实例变量是会随着对象一起分配到Java堆中。

**解析：**主要将**常量池中的符号引用替换为直接引用**的过程。符号引用就是一组符号来描述目标，可以是任何字面量，而直接引用就是直接指向目标的指针、相对偏移量或一个间接定位到目标的句柄。有类或接口的解析，字段解析，类方法解析，接口方法解析(这里涉及到字节码变量的引用，如需更详细了解，可参考《深入Java虚拟机》)。

**初始化：**类加载最后阶段，若该类具有超类，则对其进行初始化，执行静态初始化器和静态初始化成员变量(如前面只初始化了默认值的**static变量将会在这个阶段赋值**，成员变量也将被初始化)。

初始化阶段是执行类构造器＜clinit＞（）方法的过程。

**init是instance实例构造器，对非静态变量解析初始化**，而**clinit是class类构造器对静态变量，静态代码块进行初始化。**

#### 3. 数据类型和值

#### 4. 运行时数据区

#### 5. 栈针

#### 6. 特殊方法

#### 7. 类库

#### 8. 异常

#### 9. 启动加载链接初始化